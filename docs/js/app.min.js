const textbox=document.getElementById("TextBox1"),toolbar1=document.getElementById("TextBox2"),toolbar2=document.getElementById("TextBox3");function openDialog(){document.getElementById("OpenFile").click()}function singleLine(){textbox.value=textbox.value.replace(/\n/g,""),keyUp(textbox)}function distinctList(){try{var lines=textbox.value.split(/\n/),distinctLines=Array.from(new Set(lines));textbox.value=distinctLines.join("\n"),keyUp(textbox)}catch(err){alert(err.message)}}function sortList(){try{var items=toList(textbox.value);items.sort(),textbox.value=fromList(items),keyUp(textbox)}catch(err){alert(err.message)}}function toUpper(){textbox.value=textbox.value.toUpperCase()}function toLower(){textbox.value=textbox.value.toLowerCase()}function dupicateLines(){var Items=toList(textbox.value),Items=(console.log(Items),Items.map(line=>line.toString()+line.toString()));textbox.value=fromList(Items)}function trimText(method){var trimmedItems=toList(textbox.value).map(item=>item[method]());textbox.value=fromList(trimmedItems)}function urlEncode(){textbox.value=encodeURI(textbox.value)}function urlDecode(){textbox.value=decodeURI(textbox.value)}function base64Decode(){textbox.value=atob(textbox.value)}function base64Encode(){textbox.value=btoa(textbox.value)}function removeXMLNamespace(){try{textbox.value=removeXmlns(removePrefixXml(textbox.value))}catch(err){alert(err)}}function beautify(type){try{textbox.value=vkbeautify[type](textbox.value),keyUp(textbox)}catch(err){alert(err.message)}}function getDistintItemsFromLists(){var lists=extractLists();let distinct=getUniqueItemsFromArrays(lists),outputValue="";for(const list of lists)outputValue+=fromList(list.filter(obj=>-1!=distinct.indexOf(obj)))+"\n\n";textbox.value=outputValue,outputValue=""}function getMatchingItemsFromLists(){var nonEmptyLists=extractLists();let commonStrings=nonEmptyLists[0]||[];nonEmptyLists.slice(1).forEach(list=>{commonStrings=commonStrings.filter(str=>list.includes(str))}),textbox.value=fromList(commonStrings)}function speak(){var msg=new SpeechSynthesisUtterance;msg.text=textbox.value,window.speechSynthesis.speak(msg)}function txtParse(){try{var tb2=toolbar1.value;""!=tb2&&(textbox.value=parseText(textbox.value,tb2)),keyUp(textbox)}catch(err){alert(err.message)}}function insertStart(){var toolbarText=toolbar1.value;textbox.value=toolbarText+textbox.value.replace(/\n/g,"\n"+toolbarText),keyUp(textbox)}function insertEnd(){var toolbarText=toolbar1.value;textbox.value=textbox.value.replace(/\n/g,toolbarText+"\n")+toolbarText,keyUp(textbox)}function txtReplace(){try{textbox.value=textbox.value.replaceAll(toolbar1.value,toolbar2.value),keyUp(document.getElementById("TextBox1"))}catch(err){alert(err.message)}}function clearScreen(){[textbox.value,toolbar1.value,toolbar2.value]=["","",""],keyUp(textbox),sessionStorage.clear()}function copyToClipboard(){var el=document.createElement("textarea");el.value=textbox.value,document.body.appendChild(el),el.select(),document.execCommand("copy"),document.body.removeChild(el),alert("text copied to clipboard.")}function downloadFile(extension){try{var content=textbox.value,downloadLink=document.createElement("a"),filename="output_"+dateString()+"."+extension;downloadLink.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(content)),downloadLink.setAttribute("download",filename),downloadLink.style.display="none",document.body.appendChild(downloadLink),downloadLink.click(),document.body.removeChild(downloadLink)}catch(err){alert(err.message)}}function saveToCache(){var ExistingStorage=readCache();ExistingStorage.push({key:dateString(),value:textbox.value}),setCache(ExistingStorage),refreshCacheDropdown()}function clearCache(){localStorage.removeItem("CachedItems"),refreshCacheDropdown()}function readItem(s){var X=readCache().filter(item=>item.key==s)[0];textbox.value=X.value}function dateString(){var xNow=new Date;return xNow.getFullYear().toString()+`-${(xNow.getMonth()+1).toString().padStart(2,"0")}-${xNow.getDate().toString().padStart(2,"0")}-${xNow.getHours().toString().padStart(2,"0")}-${xNow.getMinutes().toString().padStart(2,"0")}-`+xNow.getSeconds().toString().padStart(2,"0")}function extractLists(){var lines=toList(textbox.value);const lists=[];let currentList=[];return lines.forEach(line=>{""===line.trim()?0<currentList.length&&(lists.push(currentList),currentList=[]):currentList.push(line.trim())}),console.log(lists),lists.filter(list=>0<list.length)}function fromList(listToJoin){return 0==listToJoin.length&&""==listToJoin[0]?"":listToJoin.join("\n")}function getLists(){var list1=[],list2=[],HasHit=!1;for(const line of toList(textbox.value))""==line?HasHit=!0:(HasHit?list1:list2).push(line);return{L1:list1,L2:list2}}function getUniqueItemsFromArrays(arrays){arrays=arrays.flat();const itemCounts={};for(const item of arrays)itemCounts[item]=(itemCounts[item]||0)+1;return Object.keys(itemCounts).filter(item=>1===itemCounts[item])}function handleDragOver(eventItem){eventItem.stopPropagation(),eventItem.preventDefault(),eventItem.dataTransfer.dropEffect="copy"}function handleFileOpen(eventItem){console.log(eventItem);var reader,eventItem=eventItem.target.files[0];eventItem&&((reader=new FileReader).onload=function(event){textbox.value=event.target.result},reader.readAsText(eventItem))}function handleFileSelect(eventItem){eventItem.stopPropagation(),eventItem.preventDefault();var reader=new FileReader;reader.onload=function(event){textbox.value=event.target.result},reader.readAsText(eventItem.dataTransfer.files[0])}function keyUp(txt){var txt=txt.value,charCount=txt.replace(/ /g,"").length,txt=txt.split("\n").length;document.getElementById("CharCount").textContent=charCount,document.getElementById("RowsCount").textContent=txt}function parseText(text,parseItem){return fromList(text.split(new RegExp(`(?=${parseItem})`,"g")))}function readCache(){return JSON.parse(localStorage.getItem("CachedItems"))||[]}function refreshCacheDropdown(){var Doc=document.getElementById("CacheList"),ExistingStorage=readCache(),temp=document.getElementsByTagName("template")[0];for(Doc.innerHTML="",item=temp.content.querySelector("a"),i=0;i<ExistingStorage.length;i++)(a=document.importNode(item,!0)).textContent=ExistingStorage[i].key,a.setAttribute("onclick","readItem('"+ExistingStorage[i].key+"')"),Doc.appendChild(a)}function removePrefixXml(xml){return xml.replace(/<[A-Z]+:/g,"<").replace(/<\/[A-Z]+:/g,"</").replace(/[A-Z]+:nil/g,"nil").replace(/[A-Z]+:type/g,"type")}function removeXmlns(xml){return xml.replace(/xmlns[^"]*"[^"]*"/g,"").replace(/\s+>/g,">")}function setCache(s){localStorage.setItem("CachedItems",JSON.stringify(s))}function toList(text){return text.split(/\n/)}document.getElementById("OpenFile").addEventListener("change",handleFileOpen),textbox.addEventListener("dragover",handleDragOver,!1),textbox.addEventListener("drop",handleFileSelect,!1),window.onbeforeunload=function(){sessionStorage.setItem("textapp.textarea",textbox.value),sessionStorage.setItem("textapp.toolbar1",toolbar1.value),sessionStorage.setItem("textapp.toolbar2",toolbar2.value)},window.onload=event=>{textbox.value=sessionStorage.getItem("textapp.textarea"),toolbar1.value=sessionStorage.getItem("textapp.toolbar1"),toolbar2.value=sessionStorage.getItem("textapp.toolbar2"),refreshCacheDropdown()};var tooltipTriggerList=[].slice.call(document.querySelectorAll('[data-toggle="tooltip"]')),tooltipList=tooltipTriggerList.map(function(tooltipTriggerEl){return new bootstrap.Tooltip(tooltipTriggerEl)});document.getElementById("btnSwitch").addEventListener("click",()=>{var invertedTheme="dark"==document.documentElement.getAttribute("data-bs-theme")?"light":"dark";document.documentElement.setAttribute("data-bs-theme",invertedTheme),localStorage.setItem("theme",invertedTheme)}),document.addEventListener("DOMContentLoaded",function(){var darkThemeMq=window.matchMedia("(prefers-color-scheme: dark)"),currentTheme=localStorage.getItem("theme");(currentTheme=!currentTheme&&darkThemeMq.matches?"dark":currentTheme)&&document.documentElement.setAttribute("data-bs-theme",currentTheme)}),document.addEventListener("DOMContentLoaded",function(){function adjustLayout(){var windowWidth=window.innerWidth,buttonGroup=document.getElementById("button-group");770<=windowWidth?buttonGroup.classList.add("btn-group-vertical"):buttonGroup.classList.remove("btn-group-vertical")}adjustLayout(),window.addEventListener("resize",function(){adjustLayout()})}),"serviceWorker"in navigator&&navigator.serviceWorker.register("./serviceWorker.min.js");